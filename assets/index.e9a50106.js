var D=Object.defineProperty,P=Object.defineProperties;var Q=Object.getOwnPropertyDescriptors;var v=Object.getOwnPropertySymbols;var E=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable;var j=(e,o,r)=>o in e?D(e,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[o]=r,g=(e,o)=>{for(var r in o||(o={}))E.call(o,r)&&j(e,r,o[r]);if(v)for(var r of v(o))F.call(o,r)&&j(e,r,o[r]);return e},A=(e,o)=>P(e,Q(o));import{P as S}from"./PageWrapper.2ddf7853.js";import{B as N}from"./BasicQuery.vue_vue&type=style&index=0&scoped=true&lang.a8f81d0a.js";import{B as G}from"./BasicQuery.bc114ab9.js";import{B as H,u as J,a as K}from"./useResourceApi.aa13ea36.js";import{_ as z,c}from"./index.a707049c.js";import{a0 as R,ah as M,E as I,r as s,o as u,j as b,w as a,b as t,c as T,i as U,F as L,h as m,t as W,d as O,ak as X}from"./vendor.b8da4354.js";import"./BasicForm.0dffb117.js";import"./BasicUpload.ee7fe252.js";const Y={name:"editTemplate",components:{BasicDrawer:H},setup(){const e=R({rules:{username:[{required:!0,message:"\u8BF7\u9009\u62E9\u914D\u7F6E\u5206\u7EC4",trigger:"change"}],nickname:[{required:!0,message:"\u8BF7\u9009\u62E9\u914D\u7F6E\u7C7B\u578B",trigger:"change"}],password:[{required:!0,pattern:/^(\w|:|.){3,50}$/,message:"\u8BF7\u9009\u62E9\u6E32\u67D3\u7EC4\u4EF6",trigger:"change"}],status:[{required:!0}]}}),{getRoles:o}=J(),{formRef:r,item:l,dialog:w,itemLoading:h,confirmLoading:i,cancelItem:d,confirmItem:p}=M("resourceApi");return A(g({},I(e)),{getRoles:o,formRef:r,item:l,dialog:w,itemLoading:h,confirmLoading:i,cancelItem:d,confirmItem:p})}},Z=m("\u542F\u7528"),x=m("\u7981\u7528"),$=m("\u53D6 \u6D88");function ee(e,o,r,l,w,h){const i=s("el-input"),d=s("el-form-item"),p=s("el-option"),V=s("el-select"),_=s("el-radio-button"),k=s("el-radio-group"),y=s("el-form"),f=s("el-button"),B=s("BasicDrawer");return u(),b(B,{title:l.item.id?"\u7F16\u8F91\u914D\u7F6E":"\u65B0\u589E\u914D\u7F6E",direction:"rtl",size:"50%",loading:l.itemLoading,modelValue:l.dialog,"onUpdate:modelValue":o[5]||(o[5]=n=>l.dialog=n),onClose:l.cancelItem},{default:a(()=>[t(y,{ref:"formRef",model:l.item,rules:e.rules,"label-width":"80px",size:"small",autocomplete:"off"},{default:a(()=>[t(d,{label:"\u7528\u6237\u6807\u8BC6",prop:"username"},{default:a(()=>[t(i,{modelValue:l.item.username,"onUpdate:modelValue":o[0]||(o[0]=n=>l.item.username=n),placeholder:"\u7528\u6237\u540D\u3001\u624B\u673A\u53F7\u3001\u90AE\u7BB1\u7B49\u552F\u4E00\u6807\u8BC6"},null,8,["modelValue"])]),_:1}),t(d,{label:"\u7528\u6237\u6635\u79F0",prop:"nickname"},{default:a(()=>[t(i,{modelValue:l.item.nickname,"onUpdate:modelValue":o[1]||(o[1]=n=>l.item.nickname=n),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u6635\u79F0"},null,8,["modelValue"])]),_:1}),t(d,{label:"\u7528\u6237\u5BC6\u7801",prop:l.item.id?"":"password"},{default:a(()=>[t(i,{modelValue:l.item.password,"onUpdate:modelValue":o[2]||(o[2]=n=>l.item.password=n),"show-password":"",minlength:"6",maxlength:"20",placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u5BC6\u7801"},null,8,["modelValue"])]),_:1},8,["prop"]),t(d,{label:"\u7528\u6237\u89D2\u8272"},{default:a(()=>[t(V,{modelValue:l.item.role_ids,"onUpdate:modelValue":o[3]||(o[3]=n=>l.item.role_ids=n),multiple:"",placeholder:"\u8BF7\u9009\u62E9\u7528\u6237\u89D2\u8272",style:{width:"100%"}},{default:a(()=>[(u(!0),T(L,null,U(l.getRoles,n=>(u(),b(p,{key:n.id,label:n.title,value:n.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(d,{label:"\u7528\u6237\u72B6\u6001",prop:"status"},{default:a(()=>[t(k,{modelValue:l.item.status,"onUpdate:modelValue":o[4]||(o[4]=n=>l.item.status=n),size:"mini"},{default:a(()=>[t(_,{label:1},{default:a(()=>[Z]),_:1}),t(_,{label:0},{default:a(()=>[x]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),footer:a(()=>[t(f,{onClick:l.cancelItem,size:"small"},{default:a(()=>[$]),_:1},8,["onClick"]),t(f,{type:"primary",size:"small",onClick:l.confirmItem,loading:l.confirmLoading},{default:a(()=>[m(W(l.confirmLoading?"\u63D0\u4EA4\u4E2D ...":"\u786E \u5B9A"),1)]),_:1},8,["onClick","loading"])]),_:1},8,["title","loading","modelValue","onClose"])}var oe=z(Y,[["render",ee]]);const ae=(e={})=>c.get("/users",{params:e}),le=(e={})=>c.get(`/users/${e.id}`),te=(e={})=>c.put(`/users/${e.id}`,{id:e.id,username:e.username,nickname:e.nickname,password:e.password,status:e.status,role_ids:e.role_ids}),ne=(e={})=>c.post("/users",{username:e.username,nickname:e.nickname,password:e.password,status:e.status,role_ids:e.role_ids}),se=(e={})=>c.delete(`/users/${e.id}`),re=O({name:"index",components:{BasicQuery:G,BasicTable:N,EditTemplate:oe,PageWrapper:S},setup(){const e=R({columns:[{prop:"id",label:"ID",width:100},{prop:"username",label:"\u7528\u6237\u540D",minWidth:100},{prop:"nickname",label:"\u6635\u79F0",minWidth:100},{prop:"roles",label:"\u89D2\u8272",minWidth:100,slot:"roles"},{prop:"status_label",label:"\u72B6\u6001",minWidth:100},{prop:"created_at",label:"\u521B\u5EFA\u65F6\u95F4",minWidth:100}],schemas:[{field:"id",placeholder:"\u7528\u6237ID",component:"Input"},{field:"username",placeholder:"\u7528\u6237\u540D",component:"Input"},{field:"nickname",placeholder:"\u6635\u79F0",component:"Input"}]}),o=K({listApi:ae,itemApi:le,updateApi:te,storeApi:ne,deleteApi:se});return X("resourceApi",o),g(g({},I(e)),I(o))}}),ie=m("\u65B0\u589E"),de=m("\u7F16\u8F91"),me=m("\u5220\u9664");function pe(e,o,r,l,w,h){const i=s("el-button"),d=s("BasicQuery"),p=s("el-card"),V=s("el-tag"),_=s("el-popconfirm"),k=s("el-table-column"),y=s("BasicTable"),f=s("EditTemplate"),B=s("page-wrapper");return u(),b(B,{title:e.$route.meta.title},{extra:a(()=>[t(i,{type:"primary",size:"mini",onClick:e.addItem},{default:a(()=>[ie]),_:1},8,["onClick"])]),default:a(()=>[t(p,{shadow:"none"},{default:a(()=>[t(d,{modelValue:e.query,"onUpdate:modelValue":o[0]||(o[0]=n=>e.query=n),schemas:e.schemas,"col-props":{span:6},onSubmit:e.getQuery},null,8,["modelValue","schemas","onSubmit"])]),_:1}),t(p,{shadow:"none",class:"mt10"},{default:a(()=>[t(y,{columns:e.columns,data:e.lists,paginate:e.paginate,loading:e.listLoading,onChangePage:e.changePage},{roles:a(n=>[(u(!0),T(L,null,U(n.row.roles,(C,q)=>(u(),b(V,{class:"mr10",key:q,size:"mini"},{default:a(()=>[m(W(C.title),1)]),_:2},1024))),128))]),default:a(()=>[t(k,{label:"\u64CD\u4F5C",width:"120"},{default:a(n=>[t(i,{type:"text",size:"small",onClick:C=>e.editItem(n.row)},{default:a(()=>[de]),_:2},1032,["onClick"]),t(_,{title:"\u5220\u9664\u4F60\u662F\u8BA4\u771F\u7684\u5417\uFF1F",iconColor:"red",onConfirm:C=>e.deleteItem(n.row)},{reference:a(()=>[t(i,{type:"text",size:"small"},{default:a(()=>[me]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["columns","data","paginate","loading","onChangePage"]),t(f,{ref:"editTemplateRef",modelValue:e.dialog,"onUpdate:modelValue":o[1]||(o[1]=n=>e.dialog=n)},null,8,["modelValue"])]),_:1})]),_:1},8,["title"])}var ke=z(re,[["render",pe]]);export{ke as default};
