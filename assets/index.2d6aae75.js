var G=Object.defineProperty,D=Object.defineProperties;var S=Object.getOwnPropertyDescriptors;var I=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,E=Object.prototype.propertyIsEnumerable;var j=(t,o,s)=>o in t?G(t,o,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[o]=s,h=(t,o)=>{for(var s in o||(o={}))W.call(o,s)&&j(t,s,o[s]);if(I)for(var s of I(o))E.call(o,s)&&j(t,s,o[s]);return t},x=(t,o)=>D(t,S(o));import{P as F}from"./PageWrapper.1edc03a2.js";import{B as Q}from"./BasicQuery.vue_vue&type=style&index=0&scoped=true&lang.e3d64a9b.js";import{B as N}from"./BasicQuery.8b41931b.js";import{B as H,u as P,a as R}from"./useResourceApi.0554b325.js";import{_ as C,d as O,e as J,f as K,h as M,j as X,k as Y,m as Z}from"./index.554bc004.js";import{a0 as $,aj as ee,E as q,r,o as u,j as g,w as a,b as n,c as w,i as L,F as k,a3 as oe,h as v,t as A,v as U,d as le,an as ae,am as te,s as T,C as ne,G as re,H as ie,a as z}from"./vendor.0028b10d.js";import{B as se}from"./BasicForm.ea101237.js";import"./BasicUpload.4c9216d9.js";const de={name:"editTemplate",components:{BasicDrawer:H},setup(){const t=$({rules:{group:[{required:!0,message:"\u8BF7\u9009\u62E9\u914D\u7F6E\u5206\u7EC4",trigger:"change"}],type:[{required:!0,message:"\u8BF7\u9009\u62E9\u914D\u7F6E\u7C7B\u578B",trigger:"change"}],component:[{required:!0,message:"\u8BF7\u9009\u62E9\u6E32\u67D3\u7EC4\u4EF6",trigger:"change"}],name:[{required:!0,message:"\u8BF7\u8F93\u5165\u914D\u7F6E\u6807\u8BC6",trigger:"blur"}],title:[{required:!0,message:"\u8BF7\u8F93\u5165\u914D\u7F6E\u6807\u9898",trigger:"blur"}],extra:[{required:!0,message:"\u8BF7\u8F93\u5165\u914D\u7F6E\u9879",trigger:"blur"}],value:[{required:!0,message:"\u8BF7\u8F93\u5165\u914D\u7F6E\u503C",trigger:"blur"}]}}),{getGroups:o,getTypes:s,getComponents:e}=P(),{formRef:V,item:b,dialog:m,itemLoading:p,confirmLoading:d,cancelItem:c,confirmItem:_}=ee("resourceApi");return x(h({},q(t)),{getGroups:o,getTypes:s,getComponents:e,formRef:V,item:b,dialog:m,itemLoading:p,confirmLoading:d,cancelItem:c,confirmItem:_})}},me=v("\u53D6 \u6D88");function ue(t,o,s,e,V,b){const m=r("el-option"),p=r("el-select"),d=r("el-form-item"),c=r("el-input"),_=r("el-form"),i=r("el-button"),f=r("BasicDrawer");return u(),g(f,{title:e.item.id?"\u7F16\u8F91\u914D\u7F6E":"\u65B0\u589E\u914D\u7F6E",direction:"rtl",size:"50%",loading:e.itemLoading,modelValue:e.dialog,"onUpdate:modelValue":o[7]||(o[7]=l=>e.dialog=l),onClose:e.cancelItem},{default:a(()=>[n(_,{ref:"formRef",model:e.item,rules:t.rules,"label-width":"80px",size:"small"},{default:a(()=>[n(d,{label:"\u914D\u7F6E\u5206\u7EC4",prop:"group"},{default:a(()=>[n(p,{modelValue:e.item.group,"onUpdate:modelValue":o[0]||(o[0]=l=>e.item.group=l),clearable:"",placeholder:"\u8BF7\u9009\u62E9\u914D\u7F6E\u5206\u7EC4",style:{width:"100%"}},{default:a(()=>[(u(!0),w(k,null,L(e.getGroups,(l,y)=>(u(),g(m,{label:l.label,value:l.value,key:y},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),n(d,{label:"\u914D\u7F6E\u7C7B\u578B",prop:"type"},{default:a(()=>[n(p,{modelValue:e.item.type,"onUpdate:modelValue":o[1]||(o[1]=l=>e.item.type=l),clearable:"",placeholder:"\u8BF7\u9009\u62E9\u914D\u7F6E\u7C7B\u578B",style:{width:"100%"}},{default:a(()=>[(u(!0),w(k,null,L(e.getTypes,(l,y)=>(u(),g(m,{label:l.label,value:l.value,key:y},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),n(d,{label:"\u6E32\u67D3\u7EC4\u4EF6",prop:"component"},{default:a(()=>[n(p,{modelValue:e.item.component,"onUpdate:modelValue":o[2]||(o[2]=l=>e.item.component=l),clearable:"",placeholder:"\u8BF7\u9009\u62E9\u6E32\u67D3\u7EC4\u4EF6",style:{width:"100%"}},{default:a(()=>[(u(!0),w(k,null,L(e.getComponents,(l,y)=>(u(),g(m,{label:l.label,value:l.value,key:y},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),n(d,{label:"\u914D\u7F6E\u6807\u8BC6",prop:"name"},{default:a(()=>[n(c,{modelValue:e.item.name,"onUpdate:modelValue":o[3]||(o[3]=l=>e.item.name=l),autocomplete:"off"},oe({_:2},[e.item.group?{name:"prepend",fn:a(()=>[v(A(e.item.group),1)])}:void 0]),1032,["modelValue"])]),_:1}),n(d,{label:"\u914D\u7F6E\u540D\u79F0",prop:"title"},{default:a(()=>[n(c,{modelValue:e.item.title,"onUpdate:modelValue":o[4]||(o[4]=l=>e.item.title=l),autocomplete:"off"},null,8,["modelValue"])]),_:1}),e.item.type==="enum"?(u(),g(d,{key:0,label:"\u914D\u7F6E\u9879",prop:"extra"},{default:a(()=>[n(c,{modelValue:e.item.extra,"onUpdate:modelValue":o[5]||(o[5]=l=>e.item.extra=l),type:"textarea",rows:"3",autocomplete:"off"},null,8,["modelValue"])]),_:1})):U("",!0),n(d,{label:"\u914D\u7F6E\u503C",prop:"value"},{default:a(()=>[n(c,{modelValue:e.item.value,"onUpdate:modelValue":o[6]||(o[6]=l=>e.item.value=l),type:"textarea",rows:"3",autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),footer:a(()=>[n(i,{onClick:e.cancelItem,size:"small"},{default:a(()=>[me]),_:1},8,["onClick"]),n(i,{type:"primary",size:"small",onClick:e.confirmItem,loading:e.confirmLoading},{default:a(()=>[v(A(e.confirmLoading?"\u63D0\u4EA4\u4E2D ...":"\u786E \u5B9A"),1)]),_:1},8,["onClick","loading"])]),_:1},8,["title","loading","modelValue","onClose"])}var pe=C(de,[["render",ue]]);const ce=le({name:"TableList",components:{BasicQuery:N,BasicTable:Q,EditTemplate:pe},setup(){const t=ae({columns:[{prop:"id",label:"ID",width:100},{prop:"title",label:"\u6807\u9898",minWidth:100},{prop:"name",label:"\u6807\u8BC6",minWidth:100},{prop:"group_label",label:"\u5206\u7EC4",minWidth:100},{prop:"type_label",label:"\u7C7B\u578B",minWidth:100},{prop:"created_at",label:"\u521B\u5EFA\u65F6\u95F4",minWidth:100}],schemas:[{field:"title",placeholder:"\u6807\u9898",component:"Input"},{field:"name",placeholder:"\u6807\u8BC6",component:"Input"}]}),o=R({listApi:O,itemApi:J,updateApi:K,storeApi:M,deleteApi:X});return te("resourceApi",o),h(h({},q(t)),q(o))}}),_e=v("\u7F16\u8F91"),fe=v("\u5220\u9664");function ge(t,o,s,e,V,b){const m=r("BasicQuery"),p=r("el-card"),d=r("el-button"),c=r("el-popconfirm"),_=r("el-table-column"),i=r("BasicTable"),f=r("EditTemplate");return u(),w(k,null,[n(p,{shadow:"none"},{default:a(()=>[n(m,{modelValue:t.query,"onUpdate:modelValue":o[0]||(o[0]=l=>t.query=l),schemas:t.schemas,"col-props":{span:6},onSubmit:t.getQuery},null,8,["modelValue","schemas","onSubmit"])]),_:1}),n(p,{shadow:"none",class:"mt10"},{default:a(()=>[n(i,{columns:t.columns,data:t.lists,paginate:t.paginate,loading:t.listLoading,onChangePage:t.changePage},{default:a(()=>[n(_,{label:"\u64CD\u4F5C",width:"120"},{default:a(l=>[n(d,{type:"text",size:"small",onClick:y=>t.editItem(l.row)},{default:a(()=>[_e]),_:2},1032,["onClick"]),n(c,{title:"\u5220\u9664\u4F60\u662F\u8BA4\u771F\u7684\u5417\uFF1F",iconColor:"red",onConfirm:y=>t.deleteItem(l.row)},{reference:a(()=>[n(d,{type:"text",size:"small"},{default:a(()=>[fe]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["columns","data","paginate","loading","onChangePage"]),n(f,{ref:"editTemplateRef",modelValue:t.dialog,"onUpdate:modelValue":o[1]||(o[1]=l=>t.dialog=l)},null,8,["modelValue"])]),_:1})],64)}var be=C(ce,[["render",ge]]);const ye={name:"GroupList",components:{BasicForm:se},setup(){const{getGroups:t}=P(),{listLoading:o,confirmLoading:s,query:e,formRef:V,item:b,lists:m,updateItem:p,getList:d}=R({listApi:Y,updateApi:Z,query:{group:"basic"}}),c=i=>Object.keys(i).map(f=>({value:f,label:i[f]})),_=T([]);return ne(m,()=>{b.value={},_.value.splice(0,_.value.length),m.value.forEach(i=>{let f={style:{width:"100%"}};switch(i.component){case"Select":f={options:c(i.parse_extra)};break;case"Upload":f={fileList:[{url:i.parse_value,name:i.parse_value}],limit:1};break}b.value[i.name]=i.value,_.value.push({field:i.name,labelProps:{title:i.title,name:i.name},component:i.component,formProps:{required:!0},componentProps:h({style:{width:"100%"}},f)})})}),{listLoading:o,confirmLoading:s,query:e,formRef:V,form:b,lists:m,schemas:_,getGroups:t,updateItem:p,getList:d}}},ve={class:"label"},Ve={class:"sub-label"};function he(t,o,s,e,V,b){const m=r("BasicForm"),p=r("el-col"),d=r("el-row"),c=r("el-tab-pane"),_=r("el-tabs"),i=r("el-card"),f=re("loading");return u(),g(i,{shadow:"none"},{default:a(()=>[n(_,{modelValue:e.query.group,"onUpdate:modelValue":o[1]||(o[1]=l=>e.query.group=l),"tab-position":"left",onTabClick:e.getList},{default:a(()=>[(u(!0),w(k,null,L(e.getGroups,(l,y)=>(u(),g(c,{key:y,label:l.label,name:l.value},{default:a(()=>[ie(n(d,null,{default:a(()=>[n(p,{xs:"24"},{default:a(()=>[e.query.group===l.value?(u(),g(m,{key:0,modelValue:e.form,"onUpdate:modelValue":o[0]||(o[0]=B=>e.form=B),"label-position":"top","action-props":{position:"left",submitButtonProps:{loading:e.confirmLoading}},schemas:e.schemas,onSubmit:e.updateItem},{label:a(({labelProps:B})=>[z("span",ve,A(B.title),1),z("span",Ve,A(B.name),1)]),_:1},8,["modelValue","action-props","schemas","onSubmit"])):U("",!0)]),_:2},1024)]),_:2},1536),[[f,e.listLoading]])]),_:2},1032,["label","name"]))),128))]),_:1},8,["modelValue","onTabClick"])]),_:1})}var we=C(ye,[["render",he],["__scopeId","data-v-e14d18ee"]]);const ke={name:"index",components:{PageWrapper:F,TableList:be,GroupList:we},setup(){const t=T("config"),o=T(null);return{mode:t,tableListRef:o,handleAdd:()=>o.value.addItem()}}},Be=v("\u914D\u7F6E\u6A21\u5F0F"),Ce=v("\u7BA1\u7406\u6A21\u5F0F"),Le=v("\u65B0\u589E");function Ae(t,o,s,e,V,b){const m=r("el-radio-button"),p=r("el-radio-group"),d=r("el-button"),c=r("table-list"),_=r("group-list"),i=r("page-wrapper");return u(),g(i,null,{title:a(()=>[n(p,{modelValue:e.mode,"onUpdate:modelValue":o[0]||(o[0]=f=>e.mode=f),size:"mini"},{default:a(()=>[n(m,{label:"config"},{default:a(()=>[Be]),_:1}),n(m,{label:"manage"},{default:a(()=>[Ce]),_:1})]),_:1},8,["modelValue"])]),extra:a(()=>[n(d,{type:"primary",size:"mini",disabled:e.mode==="config",onClick:e.handleAdd},{default:a(()=>[Le]),_:1},8,["disabled","onClick"])]),default:a(()=>[e.mode==="manage"?(u(),g(c,{key:0,ref:"tableListRef"},null,512)):U("",!0),e.mode==="config"?(u(),g(_,{key:1})):U("",!0)]),_:1})}var Ge=C(ke,[["render",Ae]]);export{Ge as default};
